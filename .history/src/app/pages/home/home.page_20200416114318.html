<ion-header [translucent]="true">
    <ion-toolbar color="primary">
        <ion-title>
            {{'MENU.home' | translate}}
        </ion-title>
    </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
    <ng-container *ngIf="profileReady">
        <ion-grid class="main-grid">
            <ion-row>
                <!-- Form -->
                <ion-col size="7" class="separate-scroll">
                    <ion-grid fixed class="ion-padding">
                        <ion-card>
                            <ion-item>
                                <ion-label color="medium">{{'PROFILE.background' | translate}}
                                </ion-label>
                                <div class="colorPicker" [style.background]="profile.colors.background" (click)="pickerBack = true"> {{profile.colors.background}}</div>
                                <ion-icon style="cursor: pointer;" *ngIf="pickerBack" slot="end" name="close" color="primary" (click)="pickerBack = false"></ion-icon>
                            </ion-item>
                            <color-sketch *ngIf="pickerBack" [color]="profile.colors.background" (onChangeComplete)="setTheme($event)" (onChange)="profile.colors.background = $event.color.hex"></color-sketch>
                            <ion-item>
                                <ion-label color="medium">{{'PROFILE.borders' | translate}}</ion-label>
                                <div class="colorPicker" [style.background]="profile.colors.contactTitle" (click)="pickerBorders= true"> {{profile.colors.contactTitle}}</div>
                                <ion-icon style="cursor: pointer;" *ngIf="pickerBorders" slot="end" name="close" color="primary" (click)="pickerBorders = false"></ion-icon>
                            </ion-item>
                            <color-sketch *ngIf="pickerBorders" [color]="profile.colors.contactTitle" (onChangeComplete)="setTheme($event)" (onChange)="profile.colors.contactTitle = $event.color.hex"></color-sketch>
                        </ion-card>
                        <ion-card>
                            <ion-item>
                                <ion-label color="medium">{{'PROFILE.cover' | translate}}</ion-label>
                                <ion-button (click)="cover.click()" expand="block" shape="round">
                                    {{'COMMON.search' | translate}}
                                </ion-button>
                                <input style="display: none" (change)="cropImage($event, 1/0.5, true, true)" type="file" #cover>
                            </ion-item>
                            <ion-item>
                                <ion-label color="medium">{{'PROFILE.photo' | translate}}</ion-label>
                                <ion-button (click)="photo.click()" expand="block" shape="round">
                                    {{'COMMON.search' | translate}}
                                </ion-button>
                                <input style="display: none" (change)="cropImage($event, 1/1, false, true)" type="file" #photo>
                            </ion-item>
                        </ion-card>
                        <ion-card>
                            <ion-item>
                                <ion-input style="width: 75%;" type="text" (ionChange)="pendingChanges()" [(ngModel)]="profile.name" placeholder="{{'LOGIN.name' | translate}}"></ion-input>
                                <div class="colorPicker" [style.background]="profile.colors.name" (click)="pickerName= true"> {{profile.colors.name}}</div>
                                <ion-icon style="cursor: pointer;" *ngIf="pickerName" slot="end" name="close" color="primary" (click)="pickerName = false"></ion-icon>
                            </ion-item>
                            <color-sketch *ngIf="pickerName" [color]="profile.colors.name" (onChangeComplete)="setTheme($event)" (onChange)="profile.colors.name = $event.color.hex"></color-sketch>
                            <ion-item>
                                <ion-input style="width: 75%;" type="text" (ionChange)="pendingChanges()" [(ngModel)]="profile.employment" placeholder="{{'PROFILE.employment' | translate}}"></ion-input>
                                <div class="colorPicker" [style.background]="profile.colors.employment" (click)="pickerEmployment= true"> {{profile.colors.employment}}</div>
                                <ion-icon style="cursor: pointer;" *ngIf="pickerEmployment" slot="end" name="close" color="primary" (click)="pickerEmployment = false"></ion-icon>
                            </ion-item>
                            <color-sketch *ngIf="pickerEmployment" [color]="profile.colors.employment" (onChangeComplete)="setTheme($event)" (onChange)="profile.colors.employment = $event.color.hex"></color-sketch>
                            <ion-item>
                                <ion-input style="width: 75%;" type="text" (ionChange)="pendingChanges()" [(ngModel)]="profile.web" placeholder="{{'PROFILE.web' | translate}}"></ion-input>
                            </ion-item>
                        </ion-card>
                        <ion-card>
                            <ion-item lines="inset">
                                <ion-icon slot="start" name="call" class="grey"></ion-icon>
                                <ion-label color="medium">{{'LOGIN.phone' | translate}}</ion-label>
                                <ion-input type="tel" (ionChange)="phoneChange($event, 'phone')" [value]="profile.phone" placeholder="{{'PROFILE.digits' | translate}}"></ion-input>
                            </ion-item>
                            <ion-item lines="inset">
                                <ion-icon slot="start" name="logo-whatsapp" class="grey"></ion-icon>
                                <ion-label color="medium">{{'PROFILE.whats' | translate}}</ion-label>
                                <ion-input type="tel" (ionChange)="phoneChange($event, 'whatsApp')" [value]="profile.whatsApp" placeholder="{{'PROFILE.digits' | translate}}"></ion-input>
                            </ion-item>
                            <ion-item>
                                <ion-icon slot="start" name="person-add" class="grey"></ion-icon>
                                <ion-label color="medium">{{'PROFILE.addContact' | translate}}</ion-label>
                                <ion-checkbox slot="end" [(ngModel)]="profile.addContact" (ionChange)="addPersonChange($event)"></ion-checkbox>
                            </ion-item>
                            <ion-item>
                                <ion-label color="medium">{{'PROFILE.buttonsColor' | translate}}</ion-label>
                                <div class="colorPicker" [style.background]="profile.colors.fillButtons" (click)="pickerButtons= true"> {{profile.colors.fillButtons}}</div>
                                <ion-icon style="cursor: pointer;" *ngIf="pickerButtons" slot="end" name="close" color="primary" (click)="pickerButtons = false"></ion-icon>
                            </ion-item>
                            <color-sketch *ngIf="pickerButtons" [color]="profile.colors.fillButtons" (onChangeComplete)="setTheme($event)" (onChange)="profile.colors.fillButtons = $event.color.hex"></color-sketch>
                            <ion-item>
                                <ion-label color="medium">{{'PROFILE.textFabColor' | translate}}</ion-label>
                                <div class="colorPicker" [style.background]="profile.colors.textButtons" (click)="pickerButtonsText= true"> {{profile.colors.textButtons}}</div>
                                <ion-icon style="cursor: pointer;" *ngIf="pickerButtonsText" slot="end" name="close" color="primary" (click)="pickerButtonsText = false"></ion-icon>
                            </ion-item>
                            <color-sketch *ngIf="pickerButtonsText" [color]="profile.colors.textButtons" (onChangeComplete)="setTheme($event)" (onChange)="profile.colors.textButtons = $event.color.hex"></color-sketch>
                        </ion-card>
                        <ion-card>
                            <ion-item *ngFor="let item of social; let i = index">
                                <ion-icon slot="start" [name]="item.icon" class="grey"></ion-icon>
                                <ion-input type="text" [(ngModel)]="item.value" placeholder="{{item.title}}"></ion-input>
                                <ion-button (click)="socialChange(i)" slot="end" shape="round">
                                    {{'COMMON.add' | translate}}
                                </ion-button>
                            </ion-item>
                        </ion-card>
                    </ion-grid>
                </ion-col>

                <!-- Template preview -->
                <ion-col size="5">
                    <div class="smartphone">
                        <div class="content" [style.background]="profile.colors.background ? profile.colors.background : 'white'">
                            <app-first [profile]="profile"></app-first>
                        </div>
                    </div>
                    <ion-button class="btn-save" (click)="reset()" expand="block" shape="round">
                        {{'COMMON.save' | translate}}
                    </ion-button>
                </ion-col>
            </ion-row>
        </ion-grid>
    </ng-container>
</ion-content>